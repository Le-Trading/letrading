{% extends 'base.html.twig' %}

{% block title %}Page de
    {{ user.fullName }}
{% endblock %}

{% block body %}
    <div class="container">
        <div class="row align-items-center">
            <div class="col-6 text-center">
                {% if user.media %}
                    <img class="avatar mb-3"
                         src="{{ vich_uploader_asset(user.media, 'avatarFile', 'App\\Entity\\Media') }}"
                         alt="Avatar de {{ user.fullName }}">
                {% else %}
                    <img class="avatar mb-3"
                         src="{{ asset('images/image-user.png') }}"
                         alt="Avatar de {{ user.fullName }}">
                {% endif %}
                <br>
                <span class="badge badge-primary">{{ user.posts|length }} posts</span>
            </div>
            <div class="col-6">
                <h1>{{ user.fullName }}</h1>
            </div>
        </div>
        <div class="col-12 m-3">
            <a href="{{ path('user_follow', {'pseudo': user.pseudo}) }}" class="btn {% if isFollowed %} btn-danger {% else %} btn-info {% endif %}trigger-follow">
                {% if isFollowed %}
                    Ne plus suivre
                {% else %}
                    Suivre
                {% endif %}
            </a>
            <a href="{{ path('create_conversation', {'id':user.id}) }}" class="btn btn-info">Envoyer mp</a>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script src="https://unpkg.com/axios@0.19.2/dist/axios.min.js"></script>
    <script type="text/javascript">
        $('.trigger-follow').click(function (event) {
            event.preventDefault();
            const url = this.href;
            axios.get(url).then(function () {
                if($('.trigger-follow').hasClass('btn-danger')){
                    $('.trigger-follow').removeClass('btn-danger').addClass('btn-info');
                    $('.trigger-follow').text("Suivre");
                }else{
                    $('.trigger-follow').removeClass('btn-info').addClass('btn-danger   ');
                    $('.trigger-follow').text("Ne plus suivre");
                }
            });
        });
    </script>
{% endblock %}
